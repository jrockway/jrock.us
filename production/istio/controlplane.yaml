apiVersion: install.istio.io/v1alpha2
kind: IstioControlPlane
metadata:
    namespace: istio-operator
    name: default
spec:
    gateways:
        components:
            egressGateway:
                enabled: false
                k8s:
                    resources:
                        requests:
                            cpu: 10m
                            memory: 40Mi
            ingressGateway:
                enabled: true
                k8s:
                    resources:
                        requests:
                            cpu: 10m
                            memory: 40Mi
    policy:
        components:
            policy:
                k8s:
                    resources:
                        requests:
                            cpu: 10m
                            memory: 100Mi
    telemetry:
        components:
            telemetry:
                k8s:
                    resources:
                        requests:
                            cpu: 50m
                            memory: 100Mi
    trafficManagement:
        components:
            pilot:
                k8s:
                    env:
                        - name: POD_NAME
                          valueFrom:
                              fieldRef:
                                  apiVersion: v1
                                  fieldPath: metadata.name
                        - name: POD_NAMESPACE
                          valueFrom:
                              fieldRef:
                                  apiVersion: v1
                                  fieldPath: metadata.namespace
                        - name: PILOT_TRACE_SAMPLING
                          value: "100"
                    resources:
                        requests:
                            cpu: 10m
                            memory: 100Mi
    values:
        global:
            disablePolicyChecks: false
            controlPlaneSecurityEnabled: false
            proxy:
                accessLogFile: /dev/stdout
                accessLogEncoding: JSON
                resources:
                    requests:
                        cpu: 10m
                        memory: 40Mi
            tracer:
                zipkin:
                    address: "jaeger-collector-headless.observability.svc.cluster.local:9411"
        pilot:
            autoscaleEnabled: false
        mixer:
            adapters:
                useAdapterCRDs: false
                kubernetesenv:
                    enabled: true
                prometheus:
                    enabled: true
                    metricsExpiryDuration: 10m
                stackdriver:
                    enabled: false
                stdio:
                    enabled: true
                    outputAsJson: true
            policy:
                autoscaleEnabled: false
            telemetry:
                autoscaleEnabled: false
        gateways:
            istio-egressgateway:
                autoscaleEnabled: false
            istio-ingressgateway:
                autoscaleEnabled: false
        grafana:
            enabled: false
        tracing:
            enabled: false
        kiali:
            enabled: false
            createDemoSecret: false
